{% extends 'base.html.twig' %}

{% block title %}Todo List{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        /* Custom styles for Todo page */
        .todo-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .todo-table th,
        .todo-table td {
            border: 1px solid #ccc;
            padding: 8px;
        }

        .todo-table th {
            background-color: #f0f0f0;
        }

        .todo-done {
            color: green;
            font-weight: bold;
        }

        .todo-not-done {
            color: red;
            font-weight: bold;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }
    </style>
{% endblock %}

{% block body %}
<div class="container">
    <h1>Todo List</h1>
    <table class="todo-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for todo in todos %}
                <tr>
                    <td>{{ todo.id }}</td>
                    <td>{{ todo.title }}</td>
                    <td class="{% if todo.done %}todo-done{% else %}todo-not-done{% endif %}">{% if todo.done %}Done{% else %}Not Done{% endif %}</td>
                    <td class="action-buttons">
                        <a href="{{ path('app_todo_show', {'id': todo.id}) }}" class="btn btn-info">Show</a>
                        <a href="{{ path('app_todo_edit', {'id': todo.id}) }}" class="btn btn-primary">Edit</a>
                        <form id="delete-form-{{ todo.id }}" action="{{ path('app_todo_delete', {'id': todo.id}) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this todo item?')">
                            <input type="hidden" name="_method" value="DELETE">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ todo.id) }}">
                            <button type="button" class="btn btn-danger" onclick="deleteTodo({{ todo.id }})">Delete</button>
                        </form>
                        
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="4">No todos found.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
    function deleteTodo(todoId) {
        if (confirm('Are you sure you want to delete this todo item?')) {
            const form = document.getElementById('delete-form-' + todoId);
            form.submit();
        }
    }
</script>

{% endblock %}
